# Cribl SDK Sandbox - Copilot Instructions

## Project Overview

This is a multi-language sandbox for experimenting with Cribl Control Plane and Cloud Management SDKs. The project supports Python, TypeScript, and Go implementations for both Control Plane and Management Plane APIs.

## SDK Package Information

### Control Plane SDKs
- **Python**: `cribl_control_plane_sdk_python` (installed from GitHub)
- **TypeScript**: `cribl-control-plane` (npm package)
- **Go**: `github.com/criblio/cribl-control-plane-sdk-go` (Go module)

### Management Plane SDKs  
- **Python**: `cribl_cloud_management_sdk_python` (installed from GitHub)
- **TypeScript**: `cribl-mgmt-plane` (npm package)
- **Go**: `github.com/criblio/cribl-cloud-management-sdk-go` (Go module)

## Rules for Code Changes

### 1. Always Verify Types and Imports

When making changes to any SDK-related code:

- **Python**: Check the actual installed package structure and available classes/methods in the installed libraries
- **TypeScript**: Verify types and exports from the npm packages (`cribl-control-plane`, `cribl-mgmt-plane`)
- **Go**: Check the Go module documentation and available types in the installed packages

### 2. SDK-Specific Considerations

#### Control Plane vs Management Plane
- **Control Plane**: Handles on-premise and cloud Stream instances, worker groups, authentication tokens
- **Management Plane**: Handles cloud-only operations like workspaces, organizations (cloud-only)

#### Authentication Patterns
- **Cloud OAuth2**: Uses `client_id`, `client_secret`, `organization_id`
- **On-premise**: Uses username/password or bearer tokens
- **Management Plane**: Always cloud OAuth2 only

### 3. Import Path Verification

Before suggesting import changes, always check:

#### Python
```python
# Control Plane
from cribl_control_plane import CriblControlPlane
from cribl_control_plane.models import Security, SchemeOauth, ProductsCore

# Management Plane  
from cribl_cloud_management import CriblCloudManagement
from cribl_cloud_management.models import Security, SchemeOauth
```

#### TypeScript
```typescript
// Control Plane
import { CriblControlPlane } from 'cribl-control-plane';
import { Security, SchemeOauth, ProductsCore } from 'cribl-control-plane/models';

// Management Plane
import { CriblCloudManagementSDK } from 'cribl-mgmt-plane';
import { Security, SchemeOauth } from 'cribl-mgmt-plane/models';
```

#### Go
```go
// Control Plane
import "github.com/criblio/cribl-control-plane-sdk-go"
import "github.com/criblio/cribl-control-plane-sdk-go/models/components"

// Management Plane
import "github.com/criblio/cribl-cloud-management-sdk-go"
import "github.com/criblio/cribl-cloud-management-sdk-go/models/components"
```

### 4. API Method Patterns

#### Common Patterns to Verify
- List operations: `client.groups.list_async()` (Python), `client.groups.list()` (TypeScript/Go)
- Authentication: `client.auth.tokens.get_async()` for Control Plane
- Parameter requirements: Check if `organization_id`, `product`, etc. are required
- Response handling: Verify `.items`, `.Object.Items`, or similar response structures

### 5. Environment Variables

Standard environment variables used across examples:
```bash
# Cloud
CRIBL_ORG_ID=your-org-id
CRIBL_CLIENT_ID=your-client-id  
CRIBL_CLIENT_SECRET=your-client-secret
CRIBL_WORKSPACE_NAME=main

# On-premise
CRIBL_SERVER_URL=http://localhost:19000
CRIBL_USERNAME=admin
CRIBL_PASSWORD=admin
```

### 6. Directory Structure

```
examples/
├── control-plane/
│   ├── python/
│   ├── typescript/  
│   └── go/
└── mgmt-plane/
    ├── python/
    ├── typescript/
    └── go/
```

### 7. Before Making Changes

1. **Check installed package versions**: Verify what's actually installed
2. **Validate import paths**: Ensure imports match the installed packages
3. **Verify API method signatures**: Check parameter names and types
4. **Test authentication flows**: Ensure auth patterns match SDK expectations
5. **Check response object structure**: Verify field names and nested objects

### 8. Common Gotchas

- **Case sensitivity**: `serverURL` vs `serverUrl`, `organizationId` vs `organizationID`
- **Async vs sync**: Python uses `_async` suffix, TypeScript/Go don't
- **Response structures**: Some SDKs use `.items`, others use `.Object.Items`
- **Authentication objects**: Parameter names vary between SDKs
- **Product enums**: `ProductsCore.STREAM` vs `ProductsCoreStream` vs string values

### 9. Testing Requirements

When making changes, ensure:
- Examples run without modification to environment variables
- Error handling is simple (just print errors, no complex handling)
- Output is clean (no emojis, minimal formatting)
- All required imports are included
- Environment variable loading works (`.env` file support)

## Development Environment

- VS Code launch configurations and tasks are provided
- Docker-compose setup for local Cribl Stream leader
- Devcontainer with all dependencies pre-installed
- All SDKs updated to latest versions on container creation
